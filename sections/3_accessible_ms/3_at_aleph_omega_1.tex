\section{Defining the Forcing}
\label{accessible_ms:at_aleph_omega_1}

Throughout this section, suppose $\mathrm{GCH}$.
We fix $\vec{U}=\seq{U_\xi \middle| \xi\leq\lambda}$ a Mitchell order-increasing system of measure, $\lambda<\kappa$, $\seq{Y_\xi\mid \xi<\lambda}$, and $\seq{r_\beta^\alpha \middle| \beta<\alpha<\lambda}$ as in Section \ref{forcing:magidor}\footnote{
  In brief, this assures that the ordinals in each $Y_\xi$ is measurable of Mitchell order $\xi$, as witnessed by the $r$-sequence of measure representatives, and with reflection in the $r$-measures.
}.

Work in $\Ult(V,U_\lambda)$ and consider $Col(\kappa^+,<j_{U_\lambda}(\kappa))=[Col(\alpha^+,<\kappa)]_{U_\lambda}$.

\begin{lemma}\thlabel{big_guide_generic}
  There is a $K\in V$ which is $Col(\kappa^+,<j_{U_\lambda}(\kappa))$-generic over $\Ult(V,U_\lambda)$.
\end{lemma}

\begin{proof}
  This is \thref{exists_guide_generic}.
\end{proof}

\begin{lemma}\thlabel{coherence_guiding_generic_family}
  Furthermore, for every $\alpha\leq\lambda$ there is a $K_\alpha\in V$ which is $Col(\kappa^+,<j_{U_\alpha}(\kappa))$-generic over $\Ult(V,U_\alpha)$, such that:
  \begin{enumerate}
    \item whenever $\alpha<\beta\leq \lambda$, $K_\alpha\in \Ult(V,U_\beta)$
    \item there is a family of functions $\seq{k_\alpha^\beta\middle| \alpha<\beta<\lambda}$ such that $K_\alpha = [\eta \mapsto k^\beta_\alpha (\eta)]_{U_\beta}$
    \item \label{coherence_guiding_generic_family:refl} in particular, for some $Z_\beta\in U_\beta$, for every $\eta\in Z_\beta$, $k^\beta_\alpha(\eta)$ is a $Col(\eta^+,<j_{r^\beta_\alpha(\eta)}(\eta))$-generic over $\Ult(V,r^\beta_\alpha(\eta))$  and $[K_\alpha \upharpoonright \eta]_{r^\beta_\alpha(\eta)}=k^\beta_\alpha(\eta)$; furthermore, this reflects downwards through $r$.
  \end{enumerate}
\end{lemma}

\begin{proof}
  The existence of $K_\alpha$ can be argued exactly as in \thref{big_guide_generic}.
  
  As for obtaining that $K_\alpha\in \Ult(V,U_\beta)$, observe that since $U_\alpha\in \Ult(V,U_\beta)$ (and by $GCH$), we simply have that $\left| j_{U_\alpha}(\kappa) \right|^{\Ult(V,U_\beta)}=2^\kappa=\kappa^+$ (by mapping $\kappa^\kappa$ onto $j_{U_\alpha}(\kappa)$ by $f \mapsto [f]_{U_\alpha}$, see for instance \cite{jech_set_theory}, Chapter 17, for details).
  Furthermore, since $U_\alpha\in \Ult(V,U_\beta)$, not only is $Col(\kappa^+,<j_{U_\alpha}(\kappa))^{\Ult(V,U_\alpha)}$ in $\Ult(V,U_\beta)$, 
  but so is the entire enumerated family $\seq{A_\rho \middle| \rho<(2^\kappa)^{\Ult(V,U_\beta)}}$ of $\Ult(V,U_\alpha)$-antichains of $Col(\kappa^+,<j_{U_\alpha}(\kappa))^{\Ult(V,U_\alpha)}$.
  
  Recall that since $\Ult(V,U_\alpha)$ is closed under $\kappa$-sequences, in $V$ we enumerate $K'_\alpha=\seq{p_\alpha \mid \alpha<\kappa^+}$ a descending chain of $Col(\kappa^+,<j_{U_\alpha}(\kappa))^{\Ult(V,U_\alpha)}$ such that for every $A_\rho$, either $p_\rho\in A_\rho$ or $p_\rho$ is below some element of $A_\rho$.
  Since $K'_\alpha$ is definable entirely from the enumerated antichains and $U_\alpha$,
  $K'_\alpha\in \Ult(V,U_\beta)$, and hence so is $K_\alpha$ the upwards closure of $K'_\alpha$.
  
  The second and third items are measure-one reflections of the first.
\end{proof}

\begin{remark}
  Our only use of $\mathrm{GCH}$ is to construct the sequence $\seq{K_\alpha \mid \alpha\leq \lambda}$ via the appropriate closure of measure ultrapowers.
  In the absence of $\mathrm{GCH}$, stronger large cardinal hypotheses suffice to have ultrapowers with the appropriate closure.
\end{remark}

The above coherent family of ultrapower collapse-generics allows us to define a Magidor-style forcing with interleaved collapses, where the collapses are ``guided" by the ultrapower generics.
In summary, conditions will similar to Magidor forcing to add a sequence $\seq{\kappa_\alpha \middle| \alpha<\lambda}$ with supremum $\kappa$, but:
\begin{itemize}
  \item $\kappa_0$ will be the new $\lambda^{++}$,
  \item between any two adjacent Magidor points $\kappa_\alpha$ and $\kappa_{\alpha+1}$ we will also force with ${Col(\kappa_\alpha^+,<\kappa_{\alpha+1})}$,
  \item extension will be as in Magidor forcing, but additionally we may strengthen collapses, and we don't allow already-collapsed ordinals to become future Magidor points,
  \item when we add new points to the growing finite subfamily of the Magidor sequence, we must also choose new collapse terms to be below some condition below the relevant guiding generic in a sense;
  \item and the conditions are restricted in such a way as to ensure that no Magidor sequence point gets collapsed, and that the poset still has a Prikry-type property.
\end{itemize}

\begin{definition}
  $\mathbb{MC}\left(\vec{U}\right)$: conditions are of the form $(f,c,A,C)$ where:
  \begin{enumerate}
    \item $dom(f),dom(c)\in [\lambda\sqcup\{-1\}]^{<\omega}$, $dom(f)=dom(c)$, and $dom(A)=dom(C)=\lambda\setminus dom(f)$, and $f(-1)=\lambda^+$. We will write $dom^+(f)$ to mean $dom(f)\cap Ord$, and similarly for $dom(c)$.
    \item For $\xi\in dom^+(f)$, $f(\xi)\in Z_\xi$, $f(\xi)>\lambda^+$, and $f$ is strictly increasing
    \item for $\xi\in dom(A)$ with $\xi<\max dom^+(f)$, let $\tau=\min\{dom^+(f)\setminus (\xi+1)\}$.
    Then $A(\xi)\in r^\tau_\xi(f(\tau))$.
    \item For $\xi\in dom(A)$ with $\xi>\max dom^+(f)$, $A(\xi)\in U_\xi$; with $\tau=\max (dom^+(f)\cap \xi)$, we further require that $A(\xi)\subseteq Z_\xi\setminus(f(\tau)+1)$.
    \item For each $\alpha \in dom(c)$, $c(\alpha)$, if $(dom(f)\setminus (\alpha+1))\neq\emptyset$, is a $Col(f(\alpha)^+,<f(\min(dom(f)\setminus (\alpha+1))))$-condition; otherwise is a $Col(f(\alpha)^+,<\kappa)$-condition
    \item for each $\alpha\in dom(A)$, for each $\beta\in dom(A)\cap \alpha$, $A(\alpha) \cap \sup c(\beta) = \emptyset$, that is, no collapsed ordinals will ever become Magidor points;
    \item $C$ acts as a measure-one system of future choices for $c$; that is, for each relevant $\alpha$, $C(\alpha)$ is a function with domain $A(\alpha)$ such that
    \begin{itemize}
      \item if $\delta\in A(\alpha)$, then $C(\alpha)(\delta)\in Col(\delta^+,<\kappa)$ if $\delta>\max dom(f)$; otherwise, letting $\xi=\min (dom(f)\setminus (\alpha+1))$, is in $Col(\delta^+,<f(\xi))$
      
      \item if $\alpha>\max dom(f)$, then $[C(\alpha)]_{U_\alpha}\in K_\alpha$; otherwise, letting $\xi=\min (dom(f)\setminus (\alpha+1))$, we have that $[C(\alpha)]_{r_\alpha^\xi(f(\xi))}\in k_\alpha^\xi(f(\xi))$.
    \end{itemize}
  \end{enumerate}
  
  We say that the condition $(f',c',A',C')\leq (f,c,A,C)$ if
  \begin{enumerate}
    \item $f' \supseteq f$ and if $\alpha \in dom^+(f')\setminus dom^+(f)$, then $f'(\alpha)\in A(\alpha)$
    \item for each $\alpha \in dom(c)$, $c'(\alpha)\leq c(\alpha)$ in the relevant collapse forcing
    \item for each $\alpha \in dom^+(c')\setminus dom^+(c)$, $c'(\alpha) \leq C(\alpha)(f'(\alpha))$
    \item for all $\alpha \in dom(A')$, $A'(\alpha)\subseteq A(\alpha)$
    \item for all $\alpha \in dom(C')$, $C'(\alpha)(\delta)\leq C(\alpha)(\delta)$ for all $\delta\in A'(\alpha)$
    
  \end{enumerate}
  As for our definition of direct extension, we will say that $(f',c',A',C')\leq^* (f,c,A,C)$ if $f'=f$;
  note that we may still strengthen collapse terms in a direct extension.
\end{definition}

\begin{remark}
  For ease of notation, and in accordance with conventions found in \cite{gitik_prikry_type_forcings}, we may write a condition $p\in \mathbb{MC}\left(\vec{U}\right)$ as
  \[
    p=(f^p,c^p,A^p,C^p)
  \]
  
  We'll say that the \emph{stem} of $p$ is $f^p$.
\end{remark}

Observe that $\mathbb{MC}\left(\vec{U}\right)$ has the $\kappa^+$-cc essentially for the same reasons as classical Magidor forcing.
Note that two conditions with the same Magidor stem need not be compatible due to their collapse terms being incompatible:

\begin{proposition}
  $\mathbb{MC}\left(\vec{U}\right)$ has the $\kappa^+$-cc.
\end{proposition}

\begin{proof}
  Observe that if $p$, $q$ are conditions such that both $f^p=f^q$ and $c^p=c^q$, then $p \compat q$; simply strengthen $A^p$, $A^q$, $C^p$, $C^q$ accordingly. 
  Thus there are only $\kappa$-many choices of incompatible stems and collapses.
\end{proof}

As with Magidor forcing, we have notions of how to project conditions, and a factoring property:

\begin{definition}\thlabel{magidor_collapse_condition_projection}
  Let $p=(f,c,A,C)\in \mathbb{MC}\left(\vec{U}\right)$ and let $\xi<\lambda$.
  Then we may define the following:
  \begin{itemize}
    \item $(p)_\xi=(f,c,A,C)_\xi=\left(f\upharpoonright (\xi+1), c \upharpoonright (\xi+1),A\upharpoonright (\xi+1), C\upharpoonright (\xi+1)\right)$
    \item $(p)^\xi=(f,c,A,C)^\xi=\left(f\upharpoonright (\lambda \setminus (\xi+1)), c \upharpoonright (\lambda \setminus (\xi+1)), A\upharpoonright (\lambda\setminus (\xi+1)), C\upharpoonright (\lambda \setminus (\xi+1))\right)$
    \item $\mathbb{MC}\left(\vec{U}\right)_{(\xi,\beta)}=\left\{(f,c,A,C)_\xi\mid (f,A)\in \mathbb{MC}\left(\vec{U}\right), \xi\in dom(f), \text{ and }f(\xi)=\beta\right\}$
    \item $\mathbb{MC}\left(\vec{U}\right)^{(\xi,\beta)}=\left\{(f,c,A,C)^\xi\mid (f,A)\in \mathbb{MC}\left(\vec{U}\right), \xi\in dom(f), \text{ and }f(\xi)=\beta\right\}$
  \end{itemize}
\end{definition}

\begin{fact}\thlabel{magidor_collapse_factoring}
  As with vanilla Magidor forcing (c.f. \thref{magidor_factoring}),
  due to our use of the reflected guiding generics $\seq{k_\alpha^\xi\middle| \alpha<\xi, \xi<\lambda}$, for each $\xi$ a limit point below $\lambda$ and each $\beta\in Y_\xi$, relative to the weakest $p$ for which $f^p(\xi)=\beta$, 
  \[
    \mathbb{MC}\left(\vec{U}\right) / p=\mathbb{MC}\left(\vec{U}\right)_{(\xi,\beta)}\times\mathbb{MC}\left(\vec{U}\right)^{(\xi,\beta)}
  \]
  so $\mathbb{MC}\left(\vec{U}\right)$ factors.
  
  In particular, 
  \[
    \mathbb{MC}\left(\vec{U}\right)_{(\xi,\beta)}=\mathbb{MC}\left(\seq{r_\alpha^\xi(\beta) \mid \alpha<\xi}\right)
  \]
  with guiding generics $\seq{k_\alpha^\xi(\beta) \mid \alpha<\xi}$,
  and
  \[
    \mathbb{MC}\left(\vec{U}\right)^{(\xi,\beta)}=\mathbb{MC}\left(\seq{U_\gamma \mid \xi<\gamma<\lambda}\right)
  \]
  (restricted to stems above $\rho^+$) with guiding generics $\seq{K_\gamma \mid \gamma<\lambda}$.
\end{fact}


As with $\mathbb{M}\left(\vec{U}\right)$, due to the factoring of \thref{magidor_collapse_factoring}, many preservation arguments that work for $\mathbb{MC}\left(\vec{U}\right)$ still reflect downwards.
The factoring will also allow us to inductively prove a characterization of genericity for $\mathbb{MC}\left(\vec{U}\right)$ in \thref{magidor_collapse_generic_iff_geometric}.

The Diagonalization Lemma for $\mathbb{MC}\left(\vec{U}\right)$ requires more assumptions than with $\mathbb{M}(\vec{U})$; due to the introduction of collapse terms, not every indexed family of step extensions below $p$ can be diagonalized.

However, a Prikry-type property still holds, and through its proof we can extract a partial Diagonalization Lemma.

As with Magidor forcing, the step extensions in question for the Prikry lemma are $a$-step extensions:

\begin{definition}
  Let $a\in [\lambda\cup\{-1\}]^{<\omega}$, let $b\subseteq a \cup \{-1\}$, and let $p,q$ be conditions with $q\leq p$. We'll say that $q$ is an $a$-step extension of $p$ if $dom(f^q)=dom(f^p)\sqcup a$.
\end{definition}

Note that $a$-step extensions, like direct extensions, may additionally extend the $c$-terms.

Also as with Magidor forcing, we want a notion of minimal extension $p\frown \vec{\nu}$ for which $f^{p\frown \vec{\nu}}=f^p \frown \vec{\nu}$:

\begin{definition}
  Let $p$ be a condition, let $\alpha \in dom(A^q)$, and let $\nu\in A^q(\alpha)$.
  Then we may define the condition $p\frown (\alpha,\nu)$ as the weakest extension $q$ of $p$ such $f^q(\alpha)=\nu$, namely:
  \begin{itemize}
    \item $f^{p\frown (\alpha,\nu)}=f^p \frown (\alpha,\nu)$
    \item $c^{p\frown (\alpha,\nu)}=c^p \frown (\alpha,C^p(\alpha)(\nu))$
    \item For $\beta>\alpha$, $A^{p\frown (\alpha,\nu)}(\beta)=A^p(\beta)\setminus \sup(C^p(\alpha)(\nu))$ and $C^{p\frown (\alpha,\nu)}(\beta)=C^p(\beta) \upharpoonright A^{p\frown (\alpha,\nu)}(\beta)$
    \item For $\beta<\alpha$, $A^{p\frown (\alpha,\nu)}(\beta)=A^p(\beta)\cap \nu \cap \{\mu \in Z_\beta \cap \nu \mid \sup C^p(\beta)(\mu)<\nu\}$; by \thref{coherence_guiding_generic_family}(\ref{coherence_guiding_generic_family:refl}), this is in $r_\beta^\alpha(\nu)$
    \item and for $\beta<\alpha$, $C^{p\frown (\alpha,\nu)}(\beta)=C^p(\beta)\upharpoonright A^{p\frown (\alpha,\nu)}(\beta)$; by \thref{coherence_guiding_generic_family}(\ref{coherence_guiding_generic_family:refl}), $[C^{p\frown (\alpha,\nu)}(\beta)]_{r_\beta^\alpha(\nu)}\in k_\beta^\alpha(\nu)$ as needed
  \end{itemize}
  
  For longer $\nu$, we define, for each $a\in [dom(A^p)]^{<\omega}$ and each strictly increasing $\vec{\nu}\in \prod_{\alpha\in a} A^p(\alpha)$, $p\frown \vec{\nu}$ similarly.
\end{definition}

\begin{lemma}[Prikry-type lemma, open dense version]\thlabel{magidor_collapse_prikry_open_dense}
  If $p$ is a condition and $\mathcal{D}$ is an open dense set, then there is a direct extension $r\leq^* p$ and an $a\in [\lambda]^{<\omega}$ such that every $a$-step extension of $r$ is in $\mathcal{D}$.
\end{lemma}

Before we prove this, we will introduce some terminology for families of direct extensions of a fixed condition:

\begin{definition}\thlabel{family_meets_dense_set_below}
  Let $p\in\mathbb{MC}\left(\vec{U}\right)$, let $\mathcal{D}$ be an open dense set, and let
  \[
    E=\left\{\vec{\nu}:a\to \kappa \middle| a\in [dom(A^p)]^{<\omega}, \vec{\nu}\in \prod_{\alpha\in a} A^p(\alpha),\text{ and }p\frown\vec{\nu}\text{ is a condition below }p\right\}
  \]
  and for each $a\in[\lambda]^{<\omega}$ such that there are valid $a$-step extensions of $p$, let 
  \[
    E_a=\{\vec{\nu}\in E \mid dom(\vec{\nu})=a\}
  \]
  Let $\seq{p_{\vec{\nu}}\middle| \vec{\nu}\in E_a\text{( or }E\text{)}}$ be an $E_a$ (or $E$)-indexed family of conditions.
  We say that such a family \emph{meets $\mathcal{D}$ below $p$ if possible} if for each $\vec{\nu}\in E_a$ (or $E$), $p_{\vec{\nu}}\leq^* p \frown \vec{\nu}$ and if there is some $r\leq^* p_{\vec{\nu}}$ such that $r\in\mathcal{D}$, then $p_{\vec{\nu}}\in\mathcal{D}$ as well.
\end{definition}

\begin{proof}[Proof of \thref{magidor_collapse_prikry_open_dense}]
  We proceed in a series of claims.
  Let $E$, and $E_a$ for each $a\in [dom(A^p)]^{<\omega}$, be as in \thref{family_meets_dense_set_below}; note that for each $\alpha\in dom(A^p)$, $E_{\{\alpha\}}=A^p(\alpha)$.
  
  \begin{claim}\thlabel{magidor_collapse_meets_dense_generic_one_step}
    For each $\alpha\in dom(A^p)$, there is a family $\seq{p_{(\alpha,\nu)} \middle| \nu\in A^p(\alpha)}$ that meets $\mathcal{D}$ below $p$ if possible such that
    \[
      [\nu\mapsto c^{p_{(\alpha,\nu)}}(\alpha)] \in K_\alpha
    \]
    (or $k_\alpha^\beta(\rho)$ if applicable).
  \end{claim}
  \begin{proof}[Proof of \thref{magidor_collapse_meets_dense_generic_one_step}]
    Without loss of generality, we argue for $\alpha>\max dom(f^p)$; for smaller $\alpha$, due to \thref{magidor_collapse_factoring}, we may factor and work over $\mathbb{MC}\left(\vec{U}\right)_{(\alpha,f^p(\alpha))}$ and $\mathbb{MC}\left(\vec{U}\right)^{(\alpha,f^p(\alpha))}$.
    
    Let $\mathcal{D}^*\subseteq Col(\kappa^+,<j_{U_\alpha}(\kappa))^{\Ult(V,U_\alpha)}$ be given by
    \[
      \mathcal{D}^*=\left\{[\nu\mapsto c^{p_{(\alpha,\nu)}}(\alpha)]_{U_\alpha} \middle| \seq{p_{(\alpha,\nu)} \middle| \nu\in A^p(\alpha)}\text{ meets }\mathcal{D}\text{ below }p\text{ if possible} \right\}
    \]
    Then $\mathcal{D}^*$ is dense below $[C^p(\alpha)]$.
    To see this, let $[b]\in Col(\kappa^+,<j_{U_\alpha}(\kappa))^{\Ult(V,U_\alpha)}$ be below $[C^p(\alpha)]$;
    simply because $[b]\leq [C^p(\alpha)]$, (on a measure one collection of $\nu\in A^p(\alpha)$) we may straightaway let $p_{(\alpha,\nu)}$ be such that $p_{(\alpha,\nu)}\leq^* p\frown (\alpha,\nu)$, $c^{p_{(\alpha,\nu)}}(\alpha)\leq b(\nu)$, and if some $r\leq^* p_{(\alpha,\nu)}$ is in $\mathcal{D}$, then $p_{(\alpha,\nu)}$ is already chosen to be in $\mathcal{D}$.
    Then $\seq{p_{(\alpha,\nu)}\middle| \nu\in A^p(\alpha)}$ meets $\mathcal{D}$ below $p$ if possible and by construction, $[\nu\mapsto c^{p_{(\alpha,\nu)}}(\alpha)]\leq[b]$.
    
    Thus by the genericity of $K_\alpha$, $\mathcal{D}^* \cap K_\alpha\neq\emptyset$ and therefore there is some $\seq{p_{(\alpha,\nu)} \middle| \nu\in A^p(\alpha)}$ that meets $\mathcal{D}$ below $p$ if possible such that $[\nu\mapsto c^{p_{(\alpha,\nu)}}(\alpha)]_{U_\alpha}\in K_\alpha$.
  \end{proof}
  
  Having the family's collapse terms at $\alpha$ in $K_\alpha$ in the ultrapower allows us to diagonalize:
  
  \begin{claim}\thlabel{magidor_collapse_diagonalize_one_step}
    Let $\seq{p_{(\alpha,\nu)}\middle| \nu\in A^p(\alpha)}$ be as in \thref{magidor_collapse_meets_dense_generic_one_step}.
    Then there is a $p_\alpha\leq^* p$ such that $\seq{p_\alpha \frown (\alpha,\nu) \middle| \nu\in A^{p_\alpha}(\alpha)}$ meets $\mathcal{D}$ below $p$ if possible.
  \end{claim}
  
  \begin{proof}[Proof of \thref{magidor_collapse_diagonalize_one_step}]
    Without loss of generality, we argue for $p$ such that $f^p=\seq{(-1,\lambda)}$; we can handle larger stems by factoring and measure one concentrations as per \thref{magidor_collapse_factoring}.
    In this reduced case, it suffices to define $A^{p_\alpha}$, $C^{p_\alpha}$, and $c^{p_\alpha}(-1)$.
    
    Observe that for each $\nu\in A^p(\alpha)$, $c^{p_{(\alpha,\nu)}}(-1)\in Col(\lambda^+,<\nu)$ which is of cardinality $\nu$.
    Thus we may view the map $\nu\mapsto c^{p_{(\alpha,\nu)}}(-1)$ as a regressive map on $A^p(\alpha)$, and so by the normality of $U_\alpha$ and Fodor's Theorem, there is some $A'\in U_\alpha$, $A'\subseteq A^p(\alpha)$, and some $c'\in Col(\lambda^+,<\kappa)$ such that for all $\nu\in A'$, $c^{p_{(\alpha,\nu)}}(-1)=c'$.
    
    Let
    \[
      c^{p_\alpha}(-1)=c'
    \]
    
    For $\beta>\alpha$, observe that for each $\nu\in A'$, $[C^{p_{(\alpha,\nu)}}(\beta)]_{U_\beta}\in K_\beta$, and thus $\{[C^{p_{(\alpha,\nu)}}(\beta)]_{U_\beta} \mid \nu\in A'\}$ is a $\kappa$-sized downwards directed subset of $K_\beta$.
    Thus, by the $\kappa^+$-distributvity $Col(\kappa^+,<j_{U_\beta}(\kappa))^{\Ult(V,U_\beta)}$, we may find some $[C']$ such that $[C']_{U_\beta}\leq [C^{p_{(\alpha,\nu)}}(\beta)]_{U_\beta}$ as witnessed by $W_\nu\in U_\beta$, for all $\nu\in A'$
    \footnote{
      This is a widely applicable forcing result: let $\mathbb{P}$ be $\kappa^+$-distributive, let $G$ be $\mathbb{P}$-generic, and let $\seq{p_\alpha \mid \alpha<\kappa}$ be a downwards directed subset of $G$.
      Then there is a $p\in G$ that is a lower bound of $\seq{p_\alpha \mid \alpha<\kappa}$.
      To see this, note that by distributivity, $\seq{p_\alpha \mid \alpha<\kappa}$ is in the ground model and $D:=\{q \mid \forall \alpha \ q\leq p_\alpha\text{ or }\exists \alpha \ p\perp p_\alpha\}$ is dense.
      Let $p\in D \cap G$. Since each $p_\alpha \in G$, $p\compat p_\alpha$ for all $\alpha$ and thus $p\leq p_\alpha$ for all $\alpha$.
    }.
    We let
    \[
      A^{p_\alpha}(\beta)=A' \cap \Delta_{\nu\in A'} W_\nu
    \]
    and let 
    \[
      C^{p_\alpha}(\beta) = C' \upharpoonright A^{p_\alpha}(\beta)
    \]
    
    For $\beta<\alpha$, recall that each $A^{p_{(\alpha,\nu)}}(\beta)\in r_\beta^\alpha(\nu)$, and each $C^{p_{(\alpha,\nu)}}(\beta)$ is a map with domain $A^{p_{(\alpha,\nu)}}(\beta)$ such that
    \begin{itemize}
      \item for each $\mu\in A^{p_{(\alpha,\nu)}}(\beta)$, $C^{p_{(\alpha,\nu)}}(\beta)(\mu)\in Col(\mu^+,<\nu)$
      \item $[C^{p_{(\alpha,\nu)}}(\beta)]_{r_\beta^\alpha(\nu)}\in k_\beta^\alpha(\nu)$
    \end{itemize}
    Let $B_{\beta,\alpha}=[\nu\mapsto A^{p_{(\alpha,\nu)}}(\beta)]_{U_\alpha}\in U_\beta$ and
    let $X_{\beta,\alpha}=[\nu\mapsto C^{p_{(\alpha,\nu)}}(\beta)]_{U_\alpha}$.
    By elementarity and the measure coherence, ${B_{\beta,\alpha}\in U_\beta}$;
    by the guiding generic coherence of \thref{coherence_guiding_generic_family},  $[X_{\beta,\alpha}]_{U_\beta}\in K_\beta$.
    
    So let $F_{\beta,\alpha}$ be a $U_\alpha$-measure-one collection of $\nu\in A'$ such that
    \begin{itemize}
      \item $B_{\beta,\alpha} \cap \nu = A^{p_{(\alpha,\nu)}}(\beta)$
      \item $X_{\beta,\alpha} \upharpoonright A^{p_{(\alpha,\nu)}}(\beta) = C^{p_{(\alpha,\nu)}}(\beta)$
    \end{itemize}
    Let
    \[
      A^{p_\alpha}(\beta)=B_{\beta,\alpha} \cap A^p(\alpha)
    \]
    and let
    \[
      C^{p_\alpha}(\beta)=X_{\beta,\alpha}\upharpoonright A^{p_\alpha}(\beta)
    \]
    We will need $F_{\beta,\alpha}$ for the next case.
    
    For $\beta=\alpha$, by the result of \thref{magidor_collapse_meets_dense_generic_one_step}, $[\nu\mapsto c^{p_{(\alpha,\nu)}}(\alpha)]_{U_\alpha}\in K_\alpha$ so let $C''$ be such that $[C'']=[\nu\mapsto c^{p_{(\alpha,\nu)}}(\alpha)]$ and let $A''$ be a measure one set witnessing this equality.
    
    Let
    \[
      A^{p_\alpha}(\alpha)=A'' \cap A' \cap \bigcap_{\beta<\alpha} F_{\beta,\alpha}
    \]
    This ensures that for every $\nu\in A^{p_\alpha}(\alpha)$, $(p_\alpha \frown (\alpha,\nu))\upharpoonright \alpha$ behaves as described above.
    
    Let
    \[
      C^{p_\alpha}(\alpha)=C''
    \]
    
    Then $p_\alpha$ is as desired.
  \end{proof}
  
  \begin{claim}\thlabel{magidor_collapse_diagonalize_all_step}
    For all $a\in [dom(A^p)]^{<\omega}$, there is a $p_a\leq^* p$ such that 
    \[
      \seq{p_a\frown \vec{\nu} \middle| p_a\frown \vec{\nu}\text{ is a valid condition}}
    \]
    meets $\mathcal{D}$ below $p$ if possible.
  \end{claim}
  
  \begin{proof}[Proof of \thref{magidor_collapse_diagonalize_all_step}]
    We induct on $|a|$; \thref{magidor_collapse_meets_dense_generic_one_step} and \thref{magidor_collapse_diagonalize_one_step} show how to find such $p_a$ for $|a|=1$.
    
    As for the induction, suppose without loss of generality that $f^p=\seq{(-1,\lambda)}$ as before;
    suppose the above statement is true for every $a$ with $|a|=n$.
    Let $\alpha=\min(a)$ and let $b=a\setminus \{\alpha\}$.
    Then by the induction hypothesis, for (measure one many) $\mu\in A^p(\alpha)$, there is some $q_\mu\leq^* p \frown (\alpha,\mu)$ such that 
    \[
      \seq{ q_\mu \frown \vec{\nu} \middle| q_\mu \frown \vec{\nu} \text{ is a valid condition}}
    \]
    meets $\mathcal{D}$ below $p$ if possible. 
    By the same argument as in \thref{magidor_collapse_meets_dense_generic_one_step}, we may assume that $[\mu\mapsto c^{q_\mu}(\alpha)\mid \alpha\in A^p(\alpha)]_{U_\alpha}\in K_\alpha$, 
    and thus by the same argument as in \thref{magidor_collapse_diagonalize_one_step}, we have some $q\leq^* p$ such that $q\frown (\alpha,\mu)\leq^* q_\mu$ whenever $\mu\in A^q(\alpha)$ and $\seq{q\frown (\alpha,\mu) \middle| \mu\in A^q(\alpha)}$ meets $\mathcal{D}$ below $p$ if possible\footnote{
      Note that the same Fodor's Theorem argument works to concentrate $A^{q}(\alpha)$ so that for every $\mu\in A^q(\alpha)$, the map $\mu\mapsto c^{q_\mu}(-1)\in Col(\lambda^+,<\mu)$ is constant.
    }.
    
    But then by construction, $\seq{q\frown \vec{\nu} \middle| \vec{\nu}\in E_a}$ meets $\mathcal{D}$ below $p$ if possible, and so $q$ is our desired $p_a$.
  \end{proof}
  
  By enumerating over all $a$ for which $p$ has valid $a$-step extensions (that is, $a\in [dom(A^p)]^{<\omega}$), 
  we may additionally construct the $\seq{q_a \mid a\in [dom(A^p)]^{<\omega}}$ such that for each $\alpha\in dom(f^p)$, $\{c^{q_a}(\alpha)\mid a\in [dom(A^p)]^{<\omega}\}$ forms a directed system in the relevant collapse forcing of size less than $\lambda^+$.
  
  Therefore, by invoking the $\lambda^+$-closure of each relevant measure
  to shrink the measure terms $A^{q_a}$,
  the $\lambda^+$-directed closure of each relevant collapse forcing to shrink the $c^{q_a}$'s,
  and the $\kappa^+$-directed closure of $Col(\kappa^+,<j_{U_\alpha}(\kappa))^{\Ult(V,U_\alpha)}$ on the $C^{q_a}$'s,
  we may let $q$ be a lower bound of $\seq{q_a\middle| a\in [dom(A^p)]^{<\omega}}$.
  
  By \thref{magidor_collapse_diagonalize_all_step}, we have that 
  \[
    \seq{q \frown \vec{\nu} \middle| \nu\in \left[\prod A^q(\alpha)\right]^{<\omega} \text{ increasing}}
  \]
  meets $\mathcal{D}$ below $q$ if possible. That means that for each applicable $\vec{\nu}$, if some direct extension of $q\frown \vec{\nu}$ lies in $\mathcal{D}$ then $q\frown \vec{\nu}\in \mathcal{D}$ already. 
  
  We will now find homogeneous families of such $\nu$, in the following sense.
  Let $h:\left[\prod A^q(\alpha)\right]^{<\omega}\to \{0,1\}$\footnote{
    $h$ as defined is not exactly a map on this domain, but rather is a map on increasing finite sequences drawn from the measure one family of $A^q(\alpha)$'s.
  },
  \[
    h(\vec{\nu})=\begin{cases}
      1 & q\frown \vec{\nu}\in\mathcal{D} \\
      0 & \text{otherwise} \\
    \end{cases}
  \]
  By \thref{simult_indisc_easy}\footnote{
    Technically, \thref{simult_indisc_easy} applies independently to $h$ on each sub-interval between points in $dom(f^q) \cup \{\kappa\}$, taking reflected measures as needed.
  }, 
  there is some $r\leq^* q$ with $c^r=c^q$ such that for every $a\in [dom(A^r)]^{<\omega}$,
  \[
    h \upharpoonright \prod^\uparrow_{\alpha\in a} A^r(\alpha)
  \]
  is constant.
  
  But then $r$ is finally as desired, as there is some $a$ so that every $a$-step extension of $r$ is in $\mathcal{D}$.
  To see this, observe that by density, there must be some $\vec{\nu}$ such that some direct extension of $r\frown \vec{\nu}\in\mathcal{D}$;
  but then $r\frown \vec{\nu}\in\mathcal{D}$, and since $r\frown\vec{\nu}\leq^* q\frown\vec{\nu}$, by construction of $q$, $q\frown \vec{\nu}\in\mathcal{D}$, so $h(\vec{\nu})=1$.
  Let $a=dom(\vec{\nu})$; by the homogeneity of $h$, every $a$-step extension of $r$ is in $\mathcal{D}$.
\end{proof}

Combining elements of the aforementioned proof yields the following restricted Diagonalization Lemma:

\begin{lemma}[Diagonalization Lemma]\thlabel{magidor_collapse_modified_diagonalization}
  Let $p\in\mathbb{MC}\left(\vec{U}\right)$; let 
  \[
    E=\left\{\vec{\nu}:a\to\kappa \middle| a\in [dom(A^p)]^{<\omega}, \vec{\nu}\in \prod_{\alpha \in a} A^p(\alpha), \text{ and }p\frown \vec{\nu}\text{ is a condition below }p\right\}
  \]
  Let $\seq{p_{\vec{\nu}} \middle| \vec{\nu}\in E}$ be a family such that:
  \begin{enumerate}
    \item $p_{\vec{\nu}}\leq^* p \frown \vec{\nu}$
    \item for all $a$, for all $\alpha\in dom(a)$, there is a $t:A^p(\alpha)\to \{p_{\vec{\nu}}\mid \vec{\nu}\in E\}$ such that $t(\mu)$ is some $\vec{\nu}$ such that $dom(\vec{\nu})=a$, $\vec{\nu}(\alpha)=\mu$, and
    \[
      \left[\mu\mapsto c^{p_{t(\mu)}}(\alpha)\right]\in K_\alpha \text{( or }k_\alpha^\beta(\rho)\text{)}
    \]
  \end{enumerate}
  Then there is some $q\leq^* p$ such that whenever $q\frown\vec{\nu}$ is a valid condition, $q\frown \vec{\nu}\leq^* p_{\vec{\nu}}$
\end{lemma}

And in the course of proving \thref{magidor_collapse_prikry_open_dense}, we obtain simultaneous homogeneity for all step extensions:

\begin{lemma}\thlabel{magidor_collapse_prikry_open_dense_addendum}
  Let $\mathcal{D}$ be open dense, let $p$ be a condition, and let $r\leq^* p$ be as in the proof of \thref{magidor_collapse_prikry_open_dense}.
  Then for every $b\in[\lambda]^{<\omega}$ for which $p$ admits $b$-step extensions, either every $b$-step extension of $r$ is in $\mathcal{D}$, or none are.
\end{lemma}

And as with vanilla Magidor forcing, we obtain the sentential version of the Prikry lemma.

The proof is functionally the same as in \thref{magidor_prikry_type_sentential}:

\begin{lemma}[Prikry-type lemma, sentential version]\thlabel{magidor_collapse_prikry_sentential}
  Let $p\in\mathbb{MC}\left(\vec{U}\right)$, and let $\sigma$ be a sentence of the forcing language. 
  Then there is some $r\leq^* p$ such that $r$ decides $\sigma$.
\end{lemma}

\begin{proof}
  Since the collection of conditions deciding $\sigma$ is open dense, by \thref{magidor_collapse_prikry_open_dense}, there is some $q\leq^* p$ and some $a$ such that every $a$-step extension of $q$ decides $\sigma$.
  
  We argue for the case of $a=\{\alpha\}$; the rest are by induction and proceed much like in vanilla Magidor forcing (c.f. \thref{magidor_prikry_type_sentential}).
  
  Let 
  \[
    A_{\sigma}=\left\{\nu\in A^q(\alpha) \mid q \frown (\alpha,\nu)\forces \sigma\right\}
  \]
  and let
  \[
    A_{\lnot\sigma}=\left\{\nu\in A^q(\alpha) \mid q \frown (\alpha,\nu)\forces \sigma\right\}
  \]
  Exactly one of $A_\sigma$ and $A_{\lnot\sigma}$ is measure one; if without loss of generality $A_\sigma$ is measure one, then let 
  \[
    A'(\beta)=\begin{cases}
      A(\beta) & \beta\neq\alpha \\
      A_\sigma & \beta=\alpha \\
    \end{cases}
  \]
  and for each $\beta\in dom(A')$, let $C'(\beta)=C(\beta)\upharpoonright A'(\beta)$.
  Then every $a$-step extension of $(f^r,c^r,A',C')$ forces $\sigma$, and thus $(f^r,c^r,A',C')\forces \sigma$.
  Note that no extension is needed to $c^r$; thus the induction steps may proceed only on the $A^{\circ}$-component with appropriate domain restriction on the $C^{\circ}$-component.
\end{proof}

Further arguments along the lines of \thref{magidor_prikry_type_open_dense_better} yield a tail-change version:

\begin{lemma}[Prikry-type lemma, tail-change version]\thlabel{magidor_collapse_prikry_open_dense_better}
  If $p$ is a condition, $\mathcal{D}$ is an open dense set, and $\beta,\beta+1\in dom(f^p)$,
  then there is a direct extension $q\leq^* p$ such that $(q)_{\beta+1} = (p)_{\beta+1}$ and whenever $a\in [dom(A^p)]^{<\omega}$, if $q'$ is an $a$-step extension of $q$ and $q'\in \mathcal{D}$, then every $a\setminus (dom(f^{q'})\cap (\beta+1))$-step extension of $(q')_{\beta+1} \frown (q)^{\beta+1}$ is also in $\mathcal{D}$.
\end{lemma}

The proof is almost identical to the analogue for $\mathbb{M}\left(\vec{U}\right)$ (c.f.  \thref{magidor_prikry_type_open_dense_better}).
The core difference here is in assuring that the collapse terms are compatible.

\begin{proof}
  For ease of notation, let $f^p(\beta)=\zeta$ and let $f^p(\beta+1)=\rho$.
  Recall that both $\zeta$ and $\rho$ are inaccessible, and so $\zeta<2^\zeta<\rho$.
  
  For each $r\leq (p)_{(\beta+1,\rho)}$ in $\mathbb{MC}\left(\vec{U}\right)_{(\beta+1,\rho)}$, by \thref{magidor_collapse_prikry_open_dense_addendum}, let $p_r\leq^* r \frown (p)^{\beta+1}$ (in the full $\mathbb{MC}\left(\vec{U}\right)$) be such that for every $b$, either every $b$-step extension of $p_r$ is in $\mathcal{D}$, or none are.
  By construction, for each $r$, $(p_r)_{\beta+1} \leq^* r$ and $(p_r)^{\beta+1} = (f^p,c^{p_r},A^{p_r},C^{p_r})^{\beta+1}$.
  
  We will additionally need that the $c^{p_r}$'s are all compatible on $[\beta+1,\lambda)$.
  If there are $\rho$-many such $r$, then since $\leq^*$ on $\mathbb{MC}\left(\vec{U}\right)^{(\beta+1,\rho)}$ is $\rho^+$-directed closed, we may recursively construct the $p_r$'s along a well-ordering of all such $r$ of order type $\rho$, so that the sequence of $(p_r)^{(\beta+1,\rho)}$'s forms a $\rho$-length descending chain.
  
  We claim that there are $\rho$-many such $r$.
  To see this, note that our choices for $f^r$ consist of elements of $[\zeta]^{<\omega}$, of which there are $\zeta<\rho$-many, and choices for $C^r$ and $A^r$ range over measures and families of collapses up to and including $\zeta$, of which there are $2^\zeta<\rho$-many.
  Finally, for $c^r$: below $\beta$, collapse terms are bounded in $\zeta$, so there are at most $\zeta$-many, and at $\beta$, $c^r(\beta)\in Col(\zeta^+,<\rho)$ and so there are $\rho$-many.
  Thus, there are $\rho$-many such $r$.
  
  Thus the family of $(p_r)^{\beta+1}$'s forms a $\rho$-length descending chain in $\leq^*$, the $\rho^+$-closed direct extension order on $\mathbb{MC}\left(\vec{U}\right)^{(\beta+1,\rho)}$.
  For each $r$, let $q_r=(p)_{\beta+1} \frown (p_r)^{\beta+1}$;
  then by construction there is a $\leq^*$-lower bound $q$ of the $q_r$'s.
  
  But then $q$ is as desired. To see this, suppose $q'\leq q$ and $q'\in\mathcal{D}$.
  Let $r=(q')_{\beta+1}$, and let $b$ be such that $q'$ is a $b$-step extension of $q$.
  Then by construction, $q'\leq r \frown (q)^{\beta+1}\leq p_r$, and by definition of $p_r$, every $b$-step extension of $p_r$, and hence any $b\setminus dom(f^r)$-step extension of $r \frown (q)^{\beta+1}$, is also in $\mathcal{D}$.
\end{proof}
Likewise, we have a similar sentential version with tail changes:

\begin{lemma}[Prikry-type lemma, tail-change sentential version]\thlabel{magidor_collapse_prikry_sentential_better}
  Let $\sigma$ be a sentence of the forcing language, let $p\in \mathbb{MC}\left(\vec{U}\right)$, and let $\beta,\beta+1\in dom(f^p)$.
  Then there is some $q\leq^* p$ such that $(q)_{\beta+1}=(p)_{\beta+1}$ and if $q'\leq q$ is such that $q'$ decides $\sigma$, then $(q')_{\beta+1} \frown (q)^{\beta+1}$ decides $\sigma$ the same way.
\end{lemma}

This proof is identical to the analogous argument for $\mathbb{M}\left(\vec{U}\right)$ (c.f.  \thref{magidor_prikry_type_sentential_better}):

\begin{proof}
  For ease of notation, let $f^p(\beta+1)=\rho$.
  As the collection of conditions deciding $\sigma$ is open dense, we may re-run the argument of \thref{magidor_collapse_prikry_open_dense_better}, but while invoking \thref{magidor_collapse_prikry_sentential} to additionally ensure that each $p_r$ as above also decides $\sigma$.
  
  Since ensuring that each $p_r$ decides $\sigma$ only involves shrinking the $A^{\circ}$ and $C^{\circ}$ components, the family of $(p_r)^{\beta+1}$'s still forms a $\rho$-length descending chain, and we may define $q$ a $\leq^*$-lower bound of the $q_r$'s as in the proof of \thref{magidor_collapse_prikry_open_dense_better}.
  
  But then if $q'\leq q$ and $q$ decides $\sigma$, then if we let $r=(q')_{\beta+1}$, we have that $q'\leq r \frown (q)^{\beta+1}\leq p_r$; since $p_r$ already decides $\sigma$, $q'$ and $q$ must decide $\sigma$ the same way, and hence $r \frown (q)^{\beta+1}$ must also decide $\sigma$ the same way as $q'$.
\end{proof}

As for cardinal arithmetic in $V^{\mathbb{MC}\left(\vec{U}\right)}$, an $\mathbb{MC}\left(\vec{U}\right)$-generic object adds a Magidor sequence $\seq{\beta_\eta \middle| \eta<\lambda}$, and collapses cardinals in $(\beta_\eta^+,\beta_{\eta+1})$ for every $\eta \in \lambda \cup\{-1\}$:

\begin{lemma} \thlabel{magidor_collapse_generic_implies_geometric}
  Let $G$ be $\mathbb{MC}\left(\vec{U}\right)$-generic.
  Let
  \[
    \vec{\beta}=\seq{\beta_\eta \middle| \eta<\lambda} = \bigcup_{p\in G} f^p
  \]
  and for each $\eta<\lambda$, let 
  \[
    F_\eta=\bigcup_{p\in G, \eta\in dom(f^p)} c^p(\eta)
  \]
  Then
  \begin{enumerate}
    \item \label{magidor_collapse_generic_implies_geometric:sequence} $\vec{\beta}$ is increasing, normal, and has supremum $\kappa$
  
    \item \label{magidor_collapse_generic_implies_geometric:measures} for all $\seq{A_\eta \middle| \eta<\lambda}\in V$ with each $A_\eta\in U_\eta$, for coboundedly many $\zeta<\lambda$, $\beta_\zeta\in A_\zeta$
    
    \item \label{magidor_collapse_generic_implies_geometric:collapses} for all $\eta$, $F_\eta$ is $Col(\beta_\eta^+,<\beta_{\eta+1})$-generic over $V$
    
    \item \label{magidor_collapse_generic_implies_geometric:collapse_futures} 
    for all $\seq{C_\eta\middle| \eta<\lambda}$ in $V$ with each $C_\eta$ a map from a measure one set in $U_\eta$ to collapses such that each $[C_\eta]\in K_\eta$: for coboundedly many $\zeta<\lambda$, $C_\zeta(\beta_\zeta)\in F_\zeta$
    
    \item and the above items reflect down to each limit ordinal $\eta<\lambda$ with respect to the reflected measures $r$ and reflected guiding generics $k$.
    More precisely, if $\eta$ is a limit ordinal below $\lambda$, then:
    \begin{enumerate}
      \item \label{magidor_collapse_generic_implies_geometric:refl_sequence} $\seq{\beta_\zeta \mid \zeta<\eta}$ is increasing, normal, and has supremum $\beta_\eta$;
      
      \item \label{magidor_collapse_generic_implies_geometric:refl_measures} for each $\seq{A_\zeta\mid \zeta<\eta}$ in $V$ with each $A_\eta$ in $r^\eta_\zeta(\beta_\eta)$, for coboundedly many $\zeta$, $\beta_\zeta\in A_\zeta$;
      
      \item \label{magidor_collapse_generic_implies_geometric:refl_collapse_futures}
      for all $\seq{C_\zeta \mid \zeta<\eta}$ in $V$ with each $C_\zeta$ a map from a measure one set in $r^\eta_\zeta(\beta_\eta)$ to collapses such that each $[C_\eta]\in k^\eta_\zeta(\beta_\eta)$: for coboundedly many $\zeta<\eta$, $C_\zeta(\beta_\zeta)\in F_\zeta$
    \end{enumerate}
  \end{enumerate}
\end{lemma}

\begin{proof}
  Items \ref{magidor_collapse_generic_implies_geometric:sequence}, \ref{magidor_collapse_generic_implies_geometric:measures},
  \ref{magidor_collapse_generic_implies_geometric:refl_sequence},
  and \ref{magidor_collapse_generic_implies_geometric:refl_measures}
  are exactly as in the standard density and/or factoring arguments for Magidor forcings (c.f. \thref{magidor_generic_implies_geometric}).
  For completeness, we argue Item \ref{magidor_collapse_generic_implies_geometric:measures}.
  For each such $\seq{A_\eta \mid \eta<\lambda}$ with each $A_\eta\in U_\eta$, the set
  \[
    \mathcal{D}_2=\{p \mid \forall \eta>\max dom(f^p) \ A^p(\eta)\subseteq A_\eta\}
  \]
  is open dense; simply take, for each such $p$, the weakest direct extension $q\leq^* p$ where for each such $\eta$, $A^q(\eta)=A^p(\eta)\cap A_\eta$.
  Then if $r\in \mathcal{D}_2\cap G$, by definition of $\beta$, $\beta_\eta\in A_\eta$ for all $\eta>\max dom(f^r)$.
  
  In the case of \ref{magidor_collapse_generic_implies_geometric:refl_measures}, we factor to $\mathbb{MC}\left(\vec{U}\right)_{(\eta,\beta_\eta)}=\mathbb{MC}\left( \seq{r_\zeta^\eta(\beta_\eta) \mid \zeta<\eta} \right)$, which is its own Magidor forcing with guided interleaved collapses, and argue similarly as for Item \ref{magidor_collapse_generic_implies_geometric:measures}.
  
  Item \ref{magidor_collapse_generic_implies_geometric:collapses} follows since below the weakest $p$ for which $f^p(\eta)=\beta_\eta$ and $f^p(\eta+1)=\beta_{\eta+1}$, the map
  \[
    q \mapsto c^q(\eta) \text{ with domain } q\leq p
  \]
  is a projection map from $\mathbb{MC}\left(\vec{U}\right)/p$ to $Col(\beta_\eta^+,<\beta_{\eta+1})$.
  
  Item \ref{magidor_collapse_generic_implies_geometric:collapse_futures} follows from the fact that given such $\seq{C_\eta \middle| \eta<\lambda}$, since the guiding generics are filters, 
  \[
    \mathcal{D}_4=\left\{p\in\mathbb{MC}\left(\vec{U}\right) \middle| 
      \begin{array}{l}
        \forall \eta \in dom(A^p) \setminus (\max dom(f^p)+1) \ [C^p(\eta)]_{U_\eta}\leq[C_\eta]_{U_\eta} \\
        \text{ as witnessed by }A^p(\eta)
      \end{array}
    \right\}
  \]
  is dense, as whenever $p$ is a condition and $\eta>\max dom(f^p)$, $[C^p(\eta)]\in K_\eta$ hence $[C^p(\eta)]\compat [C_\eta]$. 
  So let $r\in \mathcal{D}_4 \cap G$.
  For each $\eta>\max dom(f^r)$ such that $\beta_\eta\in A^r(\eta)$, by genericity, there must be some $r'\leq r$ such that $r'\in G$ and both $\eta$ and $\eta+1$ are in $dom(f^{r'})$.
  But then by genericity, $c^{r'}(\eta)\in F_\eta$, and since $r'\leq r$, we get that $F_\eta \ni c^{r'}(\eta)\leq C^r(\beta_\eta)\leq C_\eta(\beta_\eta)\in F_\eta$.
  
  Finally, Item \ref{magidor_collapse_generic_implies_geometric:refl_collapse_futures} follows from reflection and factoring:
  let $\eta$ be a limit point and work in $\mathbb{MC}\left(\vec{U}\right)_{(\eta,\beta_\eta)}$.
  Then 
  \[
    \mathcal{D}_{5c}=\left\{p\in \mathbb{MC}\left(\vec{U}\right)_{(\eta,\beta_\eta)} \middle| 
      \begin{array}{l}
        \forall \zeta \in dom(A^p) \setminus (\max dom(f^p)+1) \ [C^p(\zeta)]_{r_\zeta^\eta(\beta_\eta)}\leq[C_\eta]_{r_\zeta^\eta(\beta_\eta)} \\
        \text{ as witnessed by }A^p(\eta)
      \end{array}
    \right\}
  \]
  is dense in $\mathbb{MC}\left(\vec{U}\right)_{(\eta,\beta_\eta)}$, and we may argue as in Item \ref{magidor_collapse_generic_implies_geometric:collapse_futures}.
\end{proof}

As a result, we have the following cardinal arithmetic in $V^{\mathbb{MC}\left(\vec{U}\right)}$:

\begin{lemma}
  Let $\delta$ be a $V$-cardinal and let $\seq{\beta_\eta \middle| \eta<\lambda}$ be the Magidor sequence added by some $\mathbb{MC}\left(\vec{U}\right)$-generic $G$. Then:
  \begin{enumerate}
    \item If $\delta\in (\beta_\eta^+,\beta_{\eta+1})$ for some $\eta$, then $\delta$ is collapsed to size $\beta_\eta^+$
    \item If $\delta=\beta_\eta$ for some $\eta$ or $\delta=\kappa$, then $\delta$ is preserved
    \item If $\delta=\beta_{\eta+1}$ for some $\eta$ or $\delta=\beta_0$ or $\delta\leq \lambda^+$ or $\delta>\kappa$, then $\delta$ is $V[G]$-regular.
  \end{enumerate}
  Thus if $\lambda$ is below the first fixed point of the map $\theta \mapsto \aleph_\theta$, then in $V[G]$, $\kappa=(\aleph_{\lambda})^{V[G]}$.
  In particular, if $\lambda=\omega_1$ then $\kappa=\left(\aleph_{\omega_1}\right)^{V[G]}$.
\end{lemma}

The collapsing part is easy to see from \thref{magidor_collapse_generic_implies_geometric}, as $G$ adds $Col(\beta_\eta^+,<\beta_{\eta+1})$-generics for every $\eta$.
Much as in vanilla Magidor forcing, the preservation argument emulates \thref{magidor_preserves_cardinals} with the help of \thref{magidor_collapse_prikry_sentential_better}.

As for a characterization of genericity along the lines of \thref{magidor_geometric_iff_generic}, we have that the Magidor generic sequence is geometric, along with a geometricity notion for the collapses, as follows:

\begin{definition}[Geometricity]
  A sequence $\vec{\beta}=\seq{\beta_\eta \mid \eta<\lambda}$ of ordinals cofinal in $\kappa$ and a family of $Col(\beta_\eta^+,<\beta_{\eta+1})$-filters $\seq{F_\eta\mid \eta<\lambda}$ living in some outer model of $V$ is \emph{geometric} if the conclusions of \thref{magidor_collapse_generic_implies_geometric} hold for $\vec{\beta}$ and $\seq{F_\eta \mid \eta<\lambda}$.
\end{definition}
  
\begin{theorem}\thlabel{magidor_collapse_generic_iff_geometric}
  Suppose in some outer model of $V$ that $\vec{\beta}=\seq{\beta_\eta \mid \eta<\lambda}$ is increasing, normal, and has limit $\kappa$, and for each $\eta$, suppose $F_\eta$ be $Col(\beta_\eta^+,<\beta_{\eta+1})$-filters. 
  Suppose furthermore that $\vec{\beta}$, $\seq{F_\eta \mid \eta<\lambda}$ is geometric (note that this means each $F_\eta$ is $Col(\beta_\eta^+,<\beta_{\eta+1})$-generic over $V$\footnote{
    Note that since $Col(\beta_\eta^+,<\beta_{\eta+1})$ is $\beta_{\eta+1}$-cc, we have that whenever $\eta<\eta'$, $F_{\eta'}$ is $Col(\beta_{\eta'}^+,<\beta_{\eta'+1})$-generic over $V[F_\eta]$. So no additional work is needed to attain mutual genericity for the $F_\eta$'s.
  }).
  
  Define
  \[
    H=\left\{(f,c,A,C)\in \mathbb{MC}\left(\vec{U}\right) \middle|
      \begin{array}{l}
        \forall \eta\in dom(f) \ f(\eta)=\beta_\eta, \\
        \forall \eta\in dom(f) \ c(\eta)\in F_\eta, \\
        \text{ and }\forall \eta\in dom(A), \ \beta_\eta\in A(\eta) \text{ and }C(\eta)(\beta_\eta)\in F_\eta\\
      \end{array}
    \right\}
  \]
  Then $H$ is $\mathbb{MC}\left(\vec{U}\right)$-generic over $V$.
\end{theorem}

To emphasize the complexity of this proof here, note that  \cite{fuchs_magidor} proves a similar characterization of genericity for vanilla Magidor forcing $\mathbb{M}\left(\vec{U}\right)$.
The crux of the proof below is in having a good Diagonalization Lemma, such as \thref{magidor_collapse_modified_diagonalization}, and a Prikry-type tail-change lemma as in \thref{magidor_collapse_prikry_open_dense_better}.

\begin{proof}
  As with the characterization of genericity for Magidor forcing (c.f. \thref{magidor_geometric_iff_generic}), the proof is by induction on the length of $\vec{U}$.

  Our base case is when $\lambda=\omega$, and our forcing is $\mathbb{MC}\left(\seq{U_n\mid n<\omega}\right)$;
  let $\seq{\beta_n\mid n<\omega}$, and $F_n$ for each $n<\omega$, be such that the conclusions of \thref{magidor_collapse_generic_implies_geometric} apply.
  Let $\mathcal{D}\subseteq \mathbb{MC}\left(\seq{U_n\mid n<\omega}\right)$ be open dense.
  Without loss of generality, we work over $g$'s that are valid stems with domain $[-1,m]$ for some $m<\omega$.
  By \thref{magidor_collapse_prikry_open_dense_better}, fix  some condition $p_{g}\leq 1_{\mathbb{MC}\left(\vec{U}\right)} \frown g$ such that 
  $(p_g)_{\max dom(g)} = (1_{\mathbb{MC}\left(\vec{U}\right)} \frown g)_{\max dom(g)}$ 
  and if $r\leq p_g$ is a $b$-step extension and $r\in \mathcal{D}$, then every $b$-step extension of $(r)_m \frown (p_g)^m$ is also in $\mathcal{D}$.
  
  For each $g$, $c^{p_g}$ is trivial by construction, hence satisfies the hypothesis of our Diagonalization Lemma (\thref{magidor_collapse_modified_diagonalization}).
  Thus by \thref{magidor_collapse_modified_diagonalization}, there is a condition $p$ with $f^p=((-1,\lambda))$ such that for every $g$ for which $p\frown g\leq p$, $p\frown g \leq^* p_{g}$.
  
  What we actually need is a $q\leq^* p$ with the following property: for any $g$, $(1_{\mathbb{MC}\left(\vec{U}\right)} \frown g) \frown (q)^{\max dom(g)}\leq^* p_{g}$.
  To attain this, we define $f^q=f^{p}$ and $c^q=c^{p}$.
  As for $A^q$ and $C^q$, let
  \[
    B(n)=A^{p}(n) \cap \diagcap_{g}A^{p_{g}}(n)=A^{p}(n) \cap \left\{\alpha<\kappa \mid \forall g \ |g|<n, \max ran(g)<\alpha\implies \alpha\in A^{p_{g}}(n)\right\}
  \]
  For all $n$ observe that $\{[C^{p_{g}}(n)] \mid |g|<n\}$ forms a $\kappa$-sized directed set in a $\kappa^+$-distributive collapse forcing.
  So let $C'(n)$ be such that $[C'(n)]$ is a lower bound of the $[C^{p_{g}}(n)]$'s as witnessed by $W_n$.
  Then let $A^q(n)=B(n)\cap W_n$, and let $C^q(n)=C' \upharpoonright A^q(n)$.
  Then by construction, for any $g$, $(1_{\mathbb{MC}\left(\vec{U}\right)} \frown g) \frown (q)^{\max dom(g)}\leq^* p_{g}$.
  
  By geometricity for $\vec{\beta}$ (namely Item \ref{magidor_collapse_generic_implies_geometric:measures}) and for the collapses (Item \ref{magidor_collapse_generic_implies_geometric:collapse_futures}, there is an $m\in \omega$ such that for all $n\geq m$, $\beta_n\in A^q(n)$ and $C^q(n)(\beta_n)\in F_n$. 
  
  Let $g=\vec{\beta}\upharpoonright [-1,m-1]$.
  By construction, $(1_{\mathbb{MC}\left(\vec{U}\right)} \frown g) \frown (q)^{m-1} \leq p_{g}$.
  Since $\mathcal{D}$ is dense, let $r\leq (1_{\mathbb{MC}\left(\vec{U}\right)} \frown g) \frown (q)^{m-1}$ be such that $r\in \mathcal{D}$.
  By geometricitity, item \ref{magidor_collapse_generic_implies_geometric:collapses}, the projection of $\mathcal{D}$ to $Col(\beta_n^+,<\beta_{n+1})$, for each $n<m$, is open dense in $Col(\beta_n^+,<\beta_{n+1})$, so we may without loss of generality have that for each $n<m$, $c^{r}(n)\in F_n$.
  Also without loss of generality, let $b=dom(f^r)\setminus [-1,m-1]=[m,m+k]$ for some $k<\omega$.
  Then by definition of $p_g$, \emph{every} $b$-step extension of $(r)_{m-1} \frown (q)^{m-1}$ is in $\mathcal{D}$, 
  so let $r'=\left((r)_{m-1} \frown (q)^{m-1}\right) \frown \vec{\beta}\upharpoonright [m,m+k]$.
  Then $r'\in \mathcal{D}$.
  
  
  But then $r'\in H$. 
  To see this, note that by construction, for all $n>m+k$, $\beta_n\in A^q(n)=A^{r'}(n)$ and $C^q(n)(\beta_n)=C^{r'}(n)(\beta_n)=\in F_n$.
  Also by construction, $f^{r'}\upharpoonright m=g=\vec{\beta}\upharpoonright m$ and $c^{r'}\upharpoonright m = c^r \upharpoonright m \in \prod_{n<m} F_n$.
  And for $n\in [m,m+k]$, we explicitly defned $f^{r'}(n)=\beta_n$, and $c^{r'}(n)=C^q(n)(\beta_n)\in F_n$.  
  
  Therefore $r'\in H\cap\mathcal{D}$, and so this concludes the base case.
  
  For the successor step, suppose that $\lambda=\bar{\lambda}+\omega$ and suppose the result is true for any forcing of the form $\mathbb{MC}\left(\seq{U'_\eta \mid \eta<\bar{\lambda}}\right)$.
  Let $\vec{U}=\seq{U_\eta \mid \eta< \lambda}$, and let $\vec{\beta}=\seq{\beta_\eta \mid \eta<\lambda}$ and $\seq{F_\eta \mid \eta<\lambda}$ be geometric for $\mathbb{MC}\left(\vec{U}\right)$, with induced filter $H$.
  Let $g=\seq{(\bar{\lambda},\beta_{\bar{\lambda}})}$, and in line with the factoring of \thref{magidor_collapse_factoring}, consider $\mathbb{MC}\left(\vec{U}\right)_g \times \mathbb{MC}\left(\vec{U}\right)^g$.
  Then the induction hypothesis applies to $\mathbb{MC}\left(\vec{U}\right)_g=\mathbb{MC}\left(\seq{r_\eta^{\bar{\lambda}}(\beta_{\bar{\lambda}}) \mid \eta< \lambda}\right)$, 
  and since $\seq{\beta_\eta \mid \eta<\bar{\lambda}}$ and $\seq{F_\eta \mid \eta<\bar{\lambda}}$ are geometric for $\mathbb{MC}\left(\vec{U}\right)_g$, 
  the resulting forcing $H_g$ defined from $\seq{\beta_\eta \mid \eta<\bar{\lambda}}$ and $\seq{F_\eta \mid \eta<\bar{\lambda}}$ is generic over $V$.
  Since $\mathbb{MC}\left(\vec{U}\right)^g=\mathbb{MC}\left(\seq{U_{\bar{\lambda}+n} \mid n<\omega}\right)$,
  by arguing exactly as in the base case, the filter $H^g$ defined from $\seq{\beta_{\bar{\lambda}+n}\mid n<\omega}$ and $\seq{F_{\bar{\lambda}+n}\mid n<\omega}$ is $\mathbb{MC}\left(\vec{U}\right)^g$-generic over $V$.
  But since $\mathbb{MC}\left(\vec{U}\right)_g$ is $\beta_{\bar{\lambda}}^+$-cc, 
  and $\mathbb{MC}\left(\vec{U}\right)^g$ is $\beta_{\bar{\lambda}}^+$-distributive, 
  $H^g$ is actually $\mathbb{MC}\left(\vec{U}\right)^g$-generic over $V[H_g]$ and so $H=H_g\times Hg$ is $\mathbb{MC}\left(\vec{U}\right)$-generic over $V$.
  This concludes the successor step.
  
  For the limit step, let $\lambda=\sup_{\rho<\tau} \lambda_\rho$ with each $\lambda_\rho$ a limit ordinal.
  Our induction hypothesis is now that for each $\rho<\tau$ and for each $\seq{\beta_\eta \mid \eta<\lambda_\rho}$ and $\seq{F_\eta \mid \eta<\lambda_\rho}$ geometric for some Magidor collapse forcing $\mathbb{MC}\left(\seq{U_\eta \mid \eta< \lambda_\rho}\right)$, the resulting filter $H_\rho$ is $\mathbb{MC}\left(\seq{U_\eta \mid \eta<\lambda_\rho}\right)$-generic over $V$;
  note that if $\rho<\rho'$ then by the Product Lemma and appropriate chain condition, $H_{\rho}=H_{\rho'} \times H'$ for some $H_{\rho'}$ $\mathbb{MC}\left(\seq{U_\eta \mid \eta\leq \lambda_{\rho'}}\right)_{(\lambda_{\rho},\beta_{\lambda_{\rho}})}$-generic over $V$ and some $H'$ $\mathbb{MC}\left(\seq{U_\eta \mid \eta\leq \lambda_{\rho'}}\right)^{(\lambda_\rho,\beta_{\lambda_\rho})}$-generic over $V[H_{\rho}]$.
  
  Let $\seq{\beta_\eta \mid \eta<\lambda}$ and $\seq{F_\eta \mid \eta<\lambda}$ be geometric for some Magidor collapse forcing $\mathbb{MC}\left(\seq{U_\eta \mid \eta\leq \lambda}\right)$.
  Let $\mathcal{D}$ be dense in $\mathbb{MC}\left(\seq{U_\eta \mid \eta\leq\lambda}\right)$.
  By applying \thref{magidor_collapse_prikry_open_dense_better} to the trivial condition, for each $g$ a stem such that $\max dom(g)=\delta+1$ for some $\delta$ such that $\delta\in dom(g)$,
  take $p_g\leq^* 1_{\mathbb{MC}\left(\seq{U_\eta \mid \eta< \lambda_\rho}\right)} \frown g$ such that
  \begin{itemize}
    \item $(p_g)_{\delta+1} = \left(1_{\mathbb{MC}\left(\seq{U_\eta \mid \eta<\lambda}\right)}\right)_{\delta+1} \frown g$; in particular $c^{p_g}$ consists only of trivial collapse terms
    \item (tail-change property) for every $b\subseteq [dom(A^{p_g})]^{<\omega}$, if $q$ is a $b$-step extension of $p_g$ and $q\in\mathcal{D}$ then every $b\setminus (dom(f^q)\cap (\delta+1)$-step extension of $(q)_{\delta+1} \frown (p_g)^{\delta+1}$ is also in $\mathcal{D}$
  \end{itemize}
  (Note that before we used the notation $\vec{\nu}$ for $g$.)
  
  Since each $c^{p_g}$ consists only of trivial collapse terms, the family of $p_g$'s satisfies the hypotheses of \thref{magidor_collapse_modified_diagonalization}.
  So by \thref{magidor_collapse_modified_diagonalization}, let $p$ be such that $f^p=\seq{(-1,\lambda)}$ and whenever $g$ is a valid stem by which to extend $p$, $p \frown g\leq^* p_{g}$.
  
  By the exact same logic as in the base case, we may further refine $A^p$ and $C^p$ to a $q\leq^* p$ such that $c^q$ consists of trivial collapse terms and whenever $g$ is a stem with $\delta+1=\max dom(g)$ and $\delta\in dom(g)$, then $\left(1_{\mathbb{MC}\left(\seq{U_\eta \mid \eta<\lambda}\right)} \frown g\right)_{\delta+1} \frown (q)^{\delta+1}\leq^* p_g$.
  
  By geometricity, let $\rho$ be an ordinal such that for all $\eta\geq \lambda_\rho$, $\beta_\eta\in A^q(\eta)$ and $C^q(\eta)(\beta_\eta)\in F_\eta$.
  
  By the induction hypothesis applied to $\seq{\beta_\eta \mid \eta<\lambda_\rho}$ and $\seq{F_\eta \mid \eta<\lambda_\rho}$, we induce $H_\rho$ a $\mathbb{MC}\left(\seq{r_\eta^{\lambda_\rho}(\beta_{\lambda_\rho}) \mid \eta<\lambda_\rho}\right)$-generic filter over $V$.
  
  Let $\mathcal{D}'$ be a subset of $\mathbb{MC}\left(\seq{r_\eta^{\lambda_\rho}(\beta_{\lambda_\rho}) \mid \eta<\lambda_\rho}\right) \times Col(\beta_{\lambda_\rho}^+,<\beta_{\lambda_\rho+1})$ defined by
  \[
    \mathcal{D}'=\left\{ (r)_{\lambda_\rho} \times c^r(\lambda_\rho) \mid r\in \mathcal{D}, (r)^{\lambda_\rho}\leq (q)^{\lambda_\rho}, \text{ and }f^r(\lambda_\rho)=\beta_{\lambda_\rho}\text{ and }f^r(\lambda_\rho+1)=\beta_{\lambda_\rho+1}\right\}
  \]
  (Recall that $(r)_{\lambda_\rho}$ is essentially $r\upharpoonright (\lambda_\rho + 1)$; see \thref{magidor_collapse_condition_projection} for a complete description.)
  
  Since $c^q \upharpoonright (\lambda_\rho+1)$ consists only of trivial collapse terms, $\mathcal{D}'$ is open dense in \\
  $\mathbb{MC}\left(\seq{r_\eta^{\lambda_\rho}(\beta_{\lambda_\rho}) \mid \eta<\lambda_\rho}\right)\times Col(\beta_{\lambda_\rho}^+,<\beta_{\lambda_\rho+1})$.
  So let $r\in\mathcal{D}$ be such that $r\leq q$, $c^r(\lambda_\rho)\in F_{\lambda_\rho}$, and $(r)_{\lambda_\rho}\in H_\rho\cap \mathcal{D}'$.
  Note that by definition, $f^r(\lambda_\rho)=\beta_{\lambda_\rho}$ and $f^r(\lambda_\rho+1)=\beta_{\lambda_\rho+1}$.
  Since $(r)_{\lambda_\rho}\in H_\rho$, by the induction hypothesis we have that whenever $\xi<\lambda_\rho$, either $f^r(\xi)=\beta_\xi$ and $c^r(\xi)\in F_\xi$,
  or $\beta_\xi\in A^r(\xi)$ and $C^r(\xi)(\beta_\xi)\in F_\xi$.
  Let $g=f^r \upharpoonright (\lambda_\rho+2)$.
  \begin{claim}
    $r\leq p_g$.
  \end{claim}
  \begin{proof}[Proof of claim]
    By definition of $g$, $f^r\supseteq g = f^{p_g}$;
    since $c^{p_g}$ consists only of trivial collapse terms, $c^r \upharpoonright dom(c^{p_g})\leq c^{p_g}$.
    
    Taken together with the facts that $(r)^{\lambda_\rho}\leq (q)^{\lambda_\rho}$ and $\lambda_\rho+1=\max dom(g)$ and $\lambda_\rho\in dom(g)$, we further have that 
    \[
      r\leq \left(1_{\mathbb{MC}\left(\seq{U_\eta \mid \eta<\lambda}\right)} \frown g\right)_{\lambda_\rho+1} \frown (q)^{\lambda_\rho+1}\leq^* p_g
    \]
  \end{proof}
  
  Furthermore, $r\in \mathcal{D}$, so letting $b=dom(r)\setminus dom(g)$, by the tail-change property of $p_g$, every $b$-step extension of $(r)_{\lambda_\rho+1} \frown (p_g)^{\lambda_\rho+1}$ is also in $\mathcal{D}$.
  
  Let $r'=((r)_{\lambda_\rho+1} \frown (q)^{\lambda_\rho+1}) \frown (\vec{\beta}\upharpoonright b)$.
  By definition of $q$, $(r)_{\lambda_\rho+1} \frown (q)^{\lambda_\rho+1}\leq p_g$, so $r'$ is also a $b$-step extension of $(r)_{\lambda_\rho+1} \frown (p_g)^{\lambda_\rho+1}$.
  Therefore $r'\in\mathcal{D}$.
  As soon as we show that $r'\in H$, we have completed the limit step.
  \begin{claim}
    $r'\in H$.
  \end{claim}
  \begin{proof}[Proof of claim]
    By construction, $f^{r'}$ is a finite subsegment of $\vec{\beta}$, as $f^{r'}\upharpoonright (\lambda_\rho+2)=f^{r}\upharpoonright (\lambda_\rho+2)=g$ which is a finite subsegment of $\vec{\beta}$, and $f^{r'}\upharpoonright [\lambda_\rho+2,\lambda)=\vec{\beta}\upharpoonright b$.
    
    For $c^{r'}$: let $\xi\in dom(c^{r'})$.
    If $\xi\leq\lambda_\rho+1$, then $c^{r'}(\xi)=c^r(\xi)\in F_\xi$ by definition of $r$.
    And if $\xi>\lambda_\rho+1$, then $c^{r'}(\xi)=C^q(\xi)(\beta_\xi)\in F_\xi$ by construction of $q$.
    
    As for $A^{r'}$, for $\xi<\lambda_\rho$, we have that $A^{r'} \upharpoonright \lambda_\rho=A^r$ so $\beta_\xi\in A^{r'}(\xi)$.
    And for $\xi>\lambda_\rho$, $A^{r'}(\xi)=A^q(\xi)$ so by definition of $q$ and $\lambda_\rho$, $\beta_\xi\in A^{r'}(\xi)$.
    
    Finally, for $C^{r'}$, if $\xi<\lambda_\rho$ then $C^{r'}(\xi)(\beta_\xi)=C^r(\xi)(\beta_\xi)\in F_\xi$ by construction of $r$,
    and if $\xi>\lambda_\rho$ then $C^{r'}(\xi)(\beta_\xi)=C^q(\xi)(\beta_\xi)\in F_\xi$.
    
    Therefore by definition of $H$, $r'\in H$.
  \end{proof}
  This completes the limit step, as we have now found an $r'\in H \cap \mathcal{D}$.
  
  Therefore, by induction, for any limit $\lambda$, $H$ is $\mathbb{MC}\left(\seq{U_\eta \mid \eta<\lambda}\right)$-generic over $V$.
\end{proof}
